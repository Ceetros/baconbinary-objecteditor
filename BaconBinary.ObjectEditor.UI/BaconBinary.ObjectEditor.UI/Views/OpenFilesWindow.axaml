<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:BaconBinary.ObjectEditor.UI.ViewModels"
        x:Class="BaconBinary.ObjectEditor.UI.Views.OpenFilesWindow"
        x:DataType="vm:OpenFilesViewModel"
        Title="Open Project"
        Width="500" 
        SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        Background="{DynamicResource AppBackgroundBrush}"
        Foreground="{DynamicResource TextPrimaryBrush}">

    <Grid RowDefinitions="*, Auto" Margin="16">
        
        <StackPanel Grid.Row="0" Spacing="12">
            
            <!-- Dat Path -->
            <TextBlock Text="Project File (.dat or .meta)"/>
            <Grid ColumnDefinitions="*, Auto">
                <TextBox Grid.Column="0" Text="{Binding DatPath}" Watermark="Path to .dat or .meta file"/>
                <Button Grid.Column="1" Content="Browse..." Command="{Binding BrowseDatCommand}" Margin="8,0,0,0"/>
            </Grid>

            <!-- Spr Path -->
            <TextBlock Text="Sprite File (.spr)"/>
            <Grid ColumnDefinitions="*, Auto" IsEnabled="{Binding IsSprPathEnabled}">
                <TextBox Grid.Column="0" Text="{Binding SprPath}" Watermark="Path to .spr file"/>
                <Button Grid.Column="1" Content="Browse..." Command="{Binding BrowseSprCommand}" Margin="8,0,0,0"/>
            </Grid>

            <!-- Version & Encryption -->
            <Grid ColumnDefinitions="*, 20, *">
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Detected Version"/>
                    <Border Classes="InfoBox" Padding="8,6">
                        <TextBlock Text="{Binding DetectedVersion}" FontWeight="Bold"/>
                    </Border>
                </StackPanel>
                
                <StackPanel Grid.Column="2" IsVisible="{Binding IsEncrypted}">
                    <TextBlock Text="Encryption Key"/>
                    <TextBox Text="{Binding EncryptionKey}" PasswordChar="*" Watermark="Required for this project"/>
                </StackPanel>
            </Grid>
            
            <!-- Transparency Option -->
            <CheckBox Content="Use Transparency (Alpha Channel)" IsChecked="{Binding UseTransparency}"
                      IsVisible="{Binding ShowTransparencyOption}"/>

        </StackPanel>

        <!-- Buttons -->
        <Button Grid.Row="1" Content="Load Project" Command="{Binding LoadCommand}" CommandParameter="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}" 
                HorizontalAlignment="Right" Classes="AccentButton" Margin="0,20,0,0"/>

    </Grid>
</Window>
